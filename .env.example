# WhatsApp Poller environment configuration (single source of truth).
# Copy this file to .env and replace required placeholder values.

# Required: target WhatsApp group JID.
# Must end with @g.us.
# Example: 1234567890-123456789@g.us
GROUP_ID=1234567890-123456789@g.us

# Required: owner phone or JID used for tie override authorization.
# Accepts phone-like text or JID; normalized to <local>@c.us internally.
# Example: 905555555555
OWNER_PHONE=905555555555

# Required: comma-separated allowlist of eligible voters.
# Accepts phone-like values or JIDs; must be unique after normalization.
ALLOWED_VOTERS=905551111111,905552222222,905553333333,905554444444,905555555555

# Optional: local auth client ID used by whatsapp-web.js.
# Default: game-scheduler
CLIENT_ID=game-scheduler

# Optional: HTTP port to enable /health/live, /health/ready, and /metrics.
# Empty disables the HTTP server. Valid range: 1..65535.
# Example: 8080
HEALTH_SERVER_PORT=

# Optional: command prefix used in group chat.
# Must be non-empty if set.
# Default: !schedule
COMMAND_PREFIX=!schedule

# Optional: runtime data directory for session/database files.
# Relative paths resolve from process working directory.
# Default: ./data
DATA_DIR=./data

# Optional: run Chromium in headless mode.
# Accepted: true/false, 1/0, yes/no, on/off.
# Default: true
HEADLESS=true

# Optional: disable Chromium sandbox protections.
# Accepted: true/false, 1/0, yes/no, on/off.
# Default: false (recommended)
ALLOW_INSECURE_CHROMIUM=false

# Optional: poll auto-close timeout in hours.
# Integer >= 1.
# Default: 48
POLL_CLOSE_HOURS=48

# Optional startup mode:
# - interactive: prompt for target ISO week at startup.
# - auto: use cron scheduling and startup catch-up behavior.
# Default: interactive
WEEK_SELECTION_MODE=interactive

# Optional explicit startup week (mainly for non-interactive startup).
# Format: YYYY-Www (example: 2026-W10), must be a valid ISO week.
TARGET_WEEK=

# Optional cron expression for weekly poll creation (used in auto mode).
# Default: Monday at 12:00 in TIMEZONE.
POLL_CRON="0 12 * * 1"

# Optional poll question text.
# Default includes the configured TIMEZONE.
POLL_QUESTION="Weekly game night - pick all slots you can join (Europe/Istanbul)"

# Optional quorum threshold for closing poll early.
# Integer >= 1 and <= number of ALLOWED_VOTERS.
# Default: 5
REQUIRED_VOTERS=5

# Optional owner tie-override window after poll close, in hours.
# Integer >= 1.
# Default: 6
TIE_OVERRIDE_HOURS=6

# Optional IANA timezone used for scheduling/display.
# Example: Europe/Istanbul, America/New_York
# Default: system timezone, then Europe/Istanbul
TIMEZONE=Europe/Istanbul

# Optional inline JSON slot template.
# Set only one of SLOT_TEMPLATE_JSON or SLOT_TEMPLATE_PATH.
# Each array item must have: weekday (1-7), hour (0-23), minute (0-59).
# Example:
# SLOT_TEMPLATE_JSON='[{"weekday":1,"hour":20,"minute":0},{"weekday":6,"hour":10,"minute":0}]'
SLOT_TEMPLATE_JSON=

# Optional path to JSON slot template file.
# Relative paths resolve from process working directory.
# Set only one of SLOT_TEMPLATE_JSON or SLOT_TEMPLATE_PATH.
# Example: ./config/slot-template.json
SLOT_TEMPLATE_PATH=

# Optional: redact phone/JID-like values in logs.
# Accepted: true/false, 1/0, yes/no, on/off.
# Default: true
LOG_REDACT_SENSITIVE=true

# Optional: include stack traces in error logs.
# Accepted: true/false, 1/0, yes/no, on/off.
# Default: false
LOG_INCLUDE_STACK=false

# Optional command rate-limit count per sender window.
# Integer >= 1.
# Default: 8
COMMAND_RATE_LIMIT_COUNT=8

# Optional command rate-limit window duration in milliseconds.
# Integer >= 1000.
# Default: 60000
COMMAND_RATE_LIMIT_WINDOW_MS=60000

# Optional maximum accepted command text length.
# Integer >= 16.
# Default: 256
COMMAND_MAX_LENGTH=256
